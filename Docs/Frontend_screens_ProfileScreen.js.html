<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Frontend/screens/ProfileScreen.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/NaveFlactem/BlitzBuyr" target="_blank" class="menu-item" id="repository" >Github repo</a></h2><h3>Classes</h3><ul><li><a href="Components.CustomFlipCard.Back.html">Components.CustomFlipCard.Back</a><ul class='members'><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.Back.html#.Back.defaultProps">Back.defaultProps</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.Back.html#.Back.propTypes">Back.propTypes</a></li></ul></li><li><a href="Components.CustomFlipCard.Face.html">Components.CustomFlipCard.Face</a><ul class='members'><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.Face.html#.Face.propTypes">Face.propTypes</a></li></ul></li><li><a href="Components.CustomFlipCard.FlipCard.html">Components.CustomFlipCard.FlipCard</a><ul class='members'><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.FlipCard.defaultProps">FlipCard.defaultProps</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.lastTap">lastTap</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.measureOtherSideTimeout">measureOtherSideTimeout</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.measured">measured</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.propTypes">propTypes</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.propTypes">propTypes</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.tapTimeout">tapTimeout</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#._animation">_animation</a></li><li data-type='method' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.componentDidUpdate">componentDidUpdate</a></li><li data-type='method' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.constructor">constructor</a></li><li data-type='method' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.getDerivedStateFromProps">getDerivedStateFromProps</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-API_Accounts.html">API/Accounts</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-API_Accounts.html#~authenticateUser">authenticateUser</a></li><li data-type='method' style='display: none;'><a href="module-API_Accounts.html#~getAccounts">getAccounts</a></li><li data-type='method' style='display: none;'><a href="module-API_Accounts.html#~handleDeleteAccounts">handleDeleteAccounts</a></li><li data-type='method' style='display: none;'><a href="module-API_Accounts.html#~handleLoginRequest">handleLoginRequest</a></li><li data-type='method' style='display: none;'><a href="module-API_Accounts.html#~handleRegistrationRequest">handleRegistrationRequest</a></li></ul></li><li><a href="module-API_Listings.html">API/Listings</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~createListing">createListing</a></li><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~encodeImageToBlurhash">encodeImageToBlurhash</a></li><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~getImages">getImages</a></li><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~getListings">getListings</a></li><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~handleDeleteImages">handleDeleteImages</a></li><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~handleDeleteListing">handleDeleteListing</a></li><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~handleDeleteListings">handleDeleteListings</a></li></ul></li><li><a href="module-API_Profile.html">API/Profile</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~deleteAllLikes">deleteAllLikes</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~deleteRating">deleteRating</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~getLikes">getLikes</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~getProfilePicture">getProfilePicture</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~getRatings">getRatings</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~getUserProfile">getUserProfile</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~handleLike">handleLike</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~handleUnlike">handleUnlike</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~rateUser">rateUser</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~updateContactInfo">updateContactInfo</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~updateProfile">updateProfile</a></li></ul></li><li><a href="module-Database.html">Database</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Database.html#~areTableDefinitionsEqual">areTableDefinitionsEqual</a></li><li data-type='method' style='display: none;'><a href="module-Database.html#~createOrUpdateTable">createOrUpdateTable</a></li><li data-type='method' style='display: none;'><a href="module-Database.html#~createTables">createTables</a></li><li data-type='method' style='display: none;'><a href="module-Database.html#~extractColumnsFromDefinition">extractColumnsFromDefinition</a></li></ul></li><li><a href="module-Server.html">Server</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Server.html#~getRoot">getRoot</a></li><li data-type='method' style='display: none;'><a href="module-Server.html#~requestLogger">requestLogger</a></li></ul></li></ul><h3>Namespaces</h3><ul><li><a href="Components.html">Components</a></li><li><a href="Components.CalculateFontSize.html">Components.CalculateFontSize</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.CalculateFontSize.html#.calculateFontSize">calculateFontSize</a></li><li data-type='method' style='display: none;'><a href="Components.CalculateFontSize.html#.calculateFontSizeLocation">calculateFontSizeLocation</a></li><li data-type='method' style='display: none;'><a href="Components.CalculateFontSize.html#.calculateTagTextFontSize">calculateTagTextFontSize</a></li><li data-type='method' style='display: none;'><a href="Components.CalculateFontSize.html#.calculateTransactionFontSize">calculateTransactionFontSize</a></li></ul></li><li><a href="Components.CustomFlipCard.html">Components.CustomFlipCard</a></li><li><a href="Components.Listing.html">Components.Listing</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Listing.html#.CardOverlay">CardOverlay</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.CustomItem">CustomItem</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.DeleteButton">DeleteButton</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.LikeButton">LikeButton</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.Listing">Listing</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.MemoizedImage">MemoizedImage</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.TimeBox">TimeBox</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.getDistance">getDistance</a></li></ul></li><li><a href="Components.LocationSlider.html">Components.LocationSlider</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.LocationSlider.html#.LocationSlider">LocationSlider</a></li></ul></li><li><a href="Components.NoListings.html">Components.NoListings</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.NoListings.html#.NoListings">NoListings</a></li></ul></li><li><a href="Components.NoWifi.html">Components.NoWifi</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.NoWifi.html#.NoWifi">NoWifi</a></li></ul></li><li><a href="Components.Notifications.html">Components.Notifications</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Notifications.html#.checkListingExpiration">checkListingExpiration</a></li><li data-type='method' style='display: none;'><a href="Components.Notifications.html#.likedNotification">likedNotification</a></li><li data-type='method' style='display: none;'><a href="Components.Notifications.html#.scheduleNotification">scheduleNotification</a></li></ul></li><li><a href="Components.Swipers.html">Components.Swipers</a></li><li><a href="Components.Swipers.AndroidSwiperComponent.html">Components.Swipers.AndroidSwiperComponent</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Swipers.AndroidSwiperComponent.html#.AndroidSwiperComponent">AndroidSwiperComponent</a></li></ul></li><li><a href="Components.Swipers.IOSSwiperComponent.html">Components.Swipers.IOSSwiperComponent</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Swipers.IOSSwiperComponent.html#.IOSSwiperComponent">IOSSwiperComponent</a></li></ul></li><li><a href="Components.TagDrawer.html">Components.TagDrawer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.TagDrawer.html#.TagDrawer">TagDrawer</a></li></ul></li><li><a href="Components.TopBarHome.html">Components.TopBarHome</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.TopBarHome.html#.TopBar">TopBar</a></li></ul></li><li><a href="Components.Visuals.html">Components.Visuals</a></li><li><a href="Components.Visuals.BouncePulse.html">Components.Visuals.BouncePulse</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Visuals.BouncePulse.html#.BouncePulse">BouncePulse</a></li></ul></li><li><a href="Components.Visuals.CustomRefreshControl.html">Components.Visuals.CustomRefreshControl</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Visuals.CustomRefreshControl.html#.CustomRefreshControl">CustomRefreshControl</a></li></ul></li><li><a href="Components.Visuals.Icons.html">Components.Visuals.Icons</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Visuals.Icons.html#.Icon">Icon</a></li></ul></li><li><a href="Components.Visuals.ThemeProvider.html">Components.Visuals.ThemeProvider</a><ul class='members'><li data-type='member' style='display: none;'><a href="Components.Visuals.ThemeProvider.html#.ThemeProvider">ThemeProvider</a></li></ul></li><li><a href="Components.Visuals.TopBarGeneric.html">Components.Visuals.TopBarGeneric</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Visuals.TopBarGeneric.html#.TopBar">TopBar</a></li></ul></li><li><a href="Hooks.html">Hooks</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Hooks.html#.useBackButtonHandler">useBackButtonHandler</a></li><li data-type='method' style='display: none;'><a href="Hooks.html#.useLocation">useLocation</a></li></ul></li><li><a href="ListingData.html">ListingData</a></li><li><a href="Networking.html">Networking</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Networking.html#.fetchListings">fetchListings</a></li><li data-type='method' style='display: none;'><a href="Networking.html#.handleDeleteAccount">handleDeleteAccount</a></li><li data-type='method' style='display: none;'><a href="Networking.html#.handleDeleteAccount">handleDeleteAccount</a></li><li data-type='method' style='display: none;'><a href="Networking.html#.handleLike">handleLike</a></li><li data-type='method' style='display: none;'><a href="Networking.html#.handleListingCreation">handleListingCreation</a></li><li data-type='method' style='display: none;'><a href="Networking.html#.saveContactInfo">saveContactInfo</a></li><li data-type='method' style='display: none;'><a href="Networking.html#.saveProfileInfo">saveProfileInfo</a></li></ul></li><li><a href="ScreenDimensions.html">ScreenDimensions</a></li><li><a href="Screens.html">Screens</a></li><li><a href="Screens.AboutUs.html">Screens.AboutUs</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.AboutUs.html#.AboutUsScreen">AboutUsScreen</a></li></ul></li><li><a href="Screens.Auth.html">Screens.Auth</a></li><li><a href="Screens.Auth.Authenticate.html">Screens.Auth.Authenticate</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.Auth.Authenticate.html#.AuthenticateScreen">AuthenticateScreen</a></li><li data-type='method' style='display: none;'><a href="Screens.Auth.Authenticate.html#.clearStoredCredentials">clearStoredCredentials</a></li><li data-type='method' style='display: none;'><a href="Screens.Auth.Authenticate.html#.getStoredPassword">getStoredPassword</a></li><li data-type='method' style='display: none;'><a href="Screens.Auth.Authenticate.html#.getStoredUsername">getStoredUsername</a></li><li data-type='method' style='display: none;'><a href="Screens.Auth.Authenticate.html#.setStoredCredentials">setStoredCredentials</a></li></ul></li><li><a href="Screens.Auth.CreateAccount.html">Screens.Auth.CreateAccount</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.Auth.CreateAccount.html#.CreateAccountScreen">CreateAccountScreen</a></li></ul></li><li><a href="Screens.Auth.Login.html">Screens.Auth.Login</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.Auth.Login.html#.LoginScreen">LoginScreen</a></li></ul></li><li><a href="Screens.ChangePasswordScreen.html">Screens.ChangePasswordScreen</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.ChangePasswordScreen.html#.ChangePassword">ChangePassword</a></li></ul></li><li><a href="Screens.CreateListing.html">Screens.CreateListing</a><ul class='members'><li data-type='member' style='display: none;'><a href="Screens.CreateListing.html#.blurhash">blurhash</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.CreateListing.html#.CreateListing">CreateListing</a></li><li data-type='method' style='display: none;'><a href="Screens.CreateListing.html#.LoadingView">LoadingView</a></li><li data-type='method' style='display: none;'><a href="Screens.CreateListing.html#.MinorLoadingView">MinorLoadingView</a></li></ul></li><li><a href="Screens.EditContactInfo.html">Screens.EditContactInfo</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.EditContactInfo.html#.EditContactInfo">EditContactInfo</a></li></ul></li><li><a href="Screens.EditProfile.html">Screens.EditProfile</a></li><li><a href="Screens.HomeScreen.html">Screens.HomeScreen</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.HomeScreen.html#.HomeScreen">HomeScreen</a></li></ul></li><li><a href="Screens.ProfileScreen.html">Screens.ProfileScreen</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.ProfileScreen.html#.ContactInfoRoute">ContactInfoRoute</a></li><li data-type='method' style='display: none;'><a href="Screens.ProfileScreen.html#.ListingsRoute">ListingsRoute</a></li><li data-type='method' style='display: none;'><a href="Screens.ProfileScreen.html#.ProfileScreen">ProfileScreen</a></li><li data-type='method' style='display: none;'><a href="Screens.ProfileScreen.html#.handleContactClick">handleContactClick</a></li></ul></li><li><a href="Screens.RatingScreen.html">Screens.RatingScreen</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.RatingScreen.html#.RatingScreen">RatingScreen</a></li></ul></li><li><a href="Screens.SettingsScreen.html">Screens.SettingsScreen</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.SettingsScreen.html#.SettingsScreen">SettingsScreen</a></li></ul></li><li><a href="Styles.html">Styles</a></li><li><a href="UserSettings.html">UserSettings</a><ul class='methods'><li data-type='method' style='display: none;'><a href="UserSettings.html#.clearUserSettings">clearUserSettings</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.getColorMode">getColorMode</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.getDistance">getDistance</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.getUserSettings">getUserSettings</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.saveUserSettings">saveUserSettings</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.setDefaultUserSettings">setDefaultUserSettings</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.updateColorMode">updateColorMode</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.updateDistance">updateDistance</a></li></ul></li><li><a href="Utilities.html">Utilities</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Utilities.html#.calculateTimeSince">calculateTimeSince</a></li><li data-type='method' style='display: none;'><a href="Utilities.html#.getLocationWithRetry">getLocationWithRetry</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#Slider">Slider</a></li><li><a href="global.html#default_blurhash">default_blurhash</a></li><li><a href="global.html#getThemedStyles">getThemedStyles</a></li><li><a href="global.html#styles">styles</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">Frontend/screens/ProfileScreen.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {
  AntDesign,
  Entypo,
  MaterialCommunityIcons,
  MaterialIcons,
} from '@expo/vector-icons';
import { useIsFocused } from '@react-navigation/native';
import * as SecureStore from 'expo-secure-store';
import React, { memo, useCallback, useEffect, useState } from 'react';
import {
  Alert,
  Image,
  Linking,
  SafeAreaView,
  StatusBar,
  Text,
  TouchableOpacity,
  useWindowDimensions,
  View,
} from 'react-native';
import { FlatList, ScrollView } from 'react-native-gesture-handler';
import { TabBar, TabView } from 'react-native-tab-view';
import Listing from '../components/Listing.js';
import BouncePulse from '../components/visuals/BouncePulse.js';
import { useThemeContext } from '../components/visuals/ThemeProvider.js';
import { serverIp } from '../config.js';
import Colors from '../constants/Colors';
import { screenHeight, screenWidth } from '../constants/ScreenDimensions.js';
import { getThemedStyles } from '../constants/Styles.js';
import {
  calculateTimeSince,
  getLocationWithRetry,
} from '../constants/Utilities';
import useBackButtonHandler from '../hooks/DisableBackButton.js';
import { saveContactInfo } from '../network/Service';
import {
  clearStoredCredentials,
  getStoredPassword,
  getStoredUsername,
} from './auth/Authenticate.js';

/**
 * @namespace ProfileScreen
 * @memberof Screens
 *
 *
 */


/**
 * @function ListingsRoute
 * @memberof Screens.ProfileScreen
 * @param {Object} props - React props object
 * @param {Function} props.onPressListing - Function to call when a listing is pressed
 * @param {Array} props.data - Array of listings to display
 * @param {String} props.text - Text to display if there are no listings
 * @param {Object} props.styles - Styles object
 * @description A component that displays listings in a grid
 * @returns {JSX.Element} 
 */
const ListingsRoute = ({ onPressListing, data, text, styles }) => (
  &lt;View style={{ flex: 1 }}>
    {data.length > 0 ? (
      &lt;FlatList
        data={data}
        numColumns={3}
        renderItem={({ item }) => (
          &lt;View
            style={{
              flex: 1,
              aspectRatio: 1,
              margin: 3,
            }}
          >
            {data.length > 0 &amp;&amp; (
              &lt;TouchableOpacity onPress={() => onPressListing(item)}>
                &lt;Image
                  source={{
                    uri: `${serverIp}/img/${item.images[0].uri}`, // load the listing's first image
                  }}
                  style={{ width: '100%', height: '100%', borderRadius: 12 }}
                />
              &lt;/TouchableOpacity>
            )}
          &lt;/View>
        )}
      />
    ) : (
      &lt;Text style={styles.noListingsText}>No {text} listings found.&lt;/Text>
    )}
  &lt;/View>
);

/**
 * @function handleContactClick
 * @memberof Screens.ProfileScreen
 * @param {String} key - The key representing the type of contact information to update.
 * @param {String} data - The new value to be set for the specified contact information.
 * @returns {void}
 */
const handleContactClick = async (key, data) => {
  switch (key) {
    case 'email':
      console.log('email');
      try {
        await Linking.openURL(
          `mailto:${data}?subject=${encodeURIComponent(
            'BlitzBuyr',
          )}&amp;body=${encodeURIComponent('')}`,
        );
      } catch (error) {
        console.error('Error opening email:', error);
      }
      break;
    case 'phone':
      try {
        // Assuming `data` is your phone number
        const phoneNumber = data;
        Alert.alert(
          'Choose an action',
          'Would you like to call or text this number?',
          [
            {
              text: 'Call',
              onPress: () => Linking.openURL(`tel:${phoneNumber}`),
            },
            {
              text: 'Text',
              onPress: () => Linking.openURL(`sms:${phoneNumber}`),
            },
            {
              text: 'Cancel',
              onPress: () => console.log('Cancel Pressed'),
            },
          ],
          { cancelable: true },
        );
      } catch (error) {
        console.error('Error opening phoneNumber:', error);
      }
      break;
    case 'linkedIn':
      try {
        await Linking.openURL(`http://${key}.com/in/${data}`);
      } catch (error) {
        console.error(`Error opening ${key}:`, error);
      }
      break;
    default:
      try {
        await Linking.openURL(`http://${key}.com/${data}`);
      } catch (error) {
        console.error(`Error opening ${key}:`, error);
      }
      break;
  }
};

/**
 * @function ContactInfoRoute
 * @memberof Screens.ProfileScreen
 * @param {Object} props - React props object
 * @param {Boolean} props.selfProfile - Whether or not the profile being viewed is the user's own profile
 * @param {Object} props.contactInfo - Object containing the contact information to be displayed
 * @param {Function} props.setContactInfo - Function to set the contact information
 * @returns {JSX.Element}
 */
const ContactInfoRoute = ({ selfProfile, contactInfo, setContactInfo }) => {
  const theme = useThemeContext().theme;
  const styles = getThemedStyles(theme).ProfileScreen;
  let displayValues = Object.values(contactInfo).some(
    (value) => value.data?.length > 0,
  );

  if (!selfProfile &amp;&amp; Object.values(contactInfo).every((value) => value.hidden))
    displayValues = false;

  // hide settings
  const updateHidden = useCallback(
    async (key) => {
      const newContactInfo = {
        ...contactInfo,
        [key]: {
          ...contactInfo[key],
          hidden: !contactInfo[key].hidden,
        },
      };
      setContactInfo(newContactInfo);
      saveContactInfo(newContactInfo);

      console.log(
        `${newContactInfo[key].hidden ? 'Hidden' : 'Unhidden'} ${key}`,
      );
    },
    [contactInfo],
  );

  const formatPhoneNumber = (phoneNumberString) => {
    var cleaned = ('' + phoneNumberString).replace(/\D/g, '');
    var match = cleaned.match(/^(\d{3})(\d{3})(\d{4})$/);
    if (match) {
      return '(' + match[1] + ')-' + match[2] + '-' + match[3];
    }
    return null;
  };

  return (
    &lt;View style={styles.contactInfoContainer}>
      &lt;ScrollView>
        &lt;View>
          {displayValues ? (
            Object.entries(contactInfo).map(([key, value]) => {
              if (value.data?.length > 0) {
                const displayData =
                  key === 'phone' ? formatPhoneNumber(value.data) : value.data;
                return (
                  (selfProfile || (!selfProfile &amp;&amp; !value.hidden)) &amp;&amp; (
                    &lt;View key={key}>
                      &lt;View
                        style={{
                          flexDirection: 'row',
                          justifyContent: 'space-between',
                        }}
                      >
                        {/* Icon + Handle */}
                        &lt;TouchableOpacity
                          onPress={() => handleContactClick(key, displayData)}
                          style={styles.socialIcons}
                        >
                          &lt;AntDesign
                            name={value.icon}
                            size={24}
                            color={theme === 'light' ? 'black' : Colors.BB_bone}
                            style={{
                              opacity: value.hidden ? 0.25 : 1.0,
                            }}
                          />
                          &lt;Text
                            style={[
                              styles.socialText,
                              theme === 'light'
                                ? { color: 'black' }
                                : { color: Colors.BB_bone },
                              { opacity: value.hidden ? 0.25 : 1.0 },
                            ]}
                          >
                            {displayData}
                          &lt;/Text>
                        &lt;/TouchableOpacity>
                        {/* Visibility */}
                        {selfProfile &amp;&amp; (
                          &lt;TouchableOpacity
                            onPress={() => updateHidden(key)}
                            style={[
                              styles.socialIcons,
                              { opacity: value.hidden ? 0.25 : 1.0 },
                            ]}
                          >
                            &lt;MaterialIcons
                              name="visibility"
                              size={24}
                              color={
                                theme === 'light'
                                  ? Colors.BB_darkRedPurple
                                  : Colors.BB_violet
                              }
                            />
                          &lt;/TouchableOpacity>
                        )}
                      &lt;/View>
                    &lt;/View>
                  )
                );
              }
            })
          ) : (
            &lt;Text style={styles.noListingsText}>
              No Contact Information Available.
            &lt;/Text>
          )}
        &lt;/View>
      &lt;/ScrollView>
    &lt;/View>
  );
};

/**
 * @function ProfileScreen
 * @memberof Screens.ProfileScreen
 * @param {Object} props - React props object
 * @param {Object} props.navigation - Stack navigation object
 * @param {Object} props.route - React route object
 * @description A component that displays a user's profile
 * @returns {JSX.Element}
 */
function ProfileScreen({ navigation, route }) {
  const layout = useWindowDimensions();
  const [index, setIndex] = useState(0);
  const [profileInfo, setProfileInfo] = useState(null);
  const isFocused = useIsFocused();
  const [loading, setLoading] = useState(true);
  const [profileName, setProfileName] = useState('');
  const [selfProfile, setSelfProfile] = useState(null); // this needs to be a global state or something, after auth so we don't keep doing this everywhere.
  const [routes, setRoutes] = useState([]);
  const [selectedListing, setSelectedListing] = useState(null);
  const [userLocation, setUserLocation] = useState(null);
  const [LikeStates, setLikeStates] = useState({});
  const theme = useThemeContext().theme;
  const styles = getThemedStyles(theme).ProfileScreen;

  // Use states for contact info
  const [contactInfo, setContactInfo] = useState({
    phone: { data: '2132149702', hidden: false, icon: 'phone' },
    email: { data: 'Email', hidden: false, icon: 'mail' },
    linkedIn: { data: 'LinkedIn', hidden: false, icon: 'linkedin-square' },
    instagram: { data: 'Instagram', hidden: false, icon: 'instagram' },
    facebook: { data: 'Facebook', hidden: false, icon: 'facebook-square' },
    twitter: { data: 'Twitter', hidden: false, icon: 'twitter' },
  });

  const onBackPress = () => {
    return true;
  };

  useBackButtonHandler(onBackPress);

  const onPressListing = (listingDetails) => {
    setSelectedListing(listingDetails);
  };

  useEffect(() => {
    const fetchUsername = async () => {
      const username = getStoredUsername();
      if (route.params?.username) {
        console.log(
          `Setting username to passed username ${route.params.username}`,
        );
        // we navigated with a username passed as param (i.e. clicking someone's profile)
        setProfileName(route.params.username);
        setSelfProfile(false);
      } else {
        console.log(`Setting username to cached logged in user`);
        setProfileName(username);
        setSelfProfile(true);
      }
      getProfileInfo(route.params?.username ? route.params.username : username);
    };

    const getUserLocation = async () => {
      console.log("Getting user's location...");

      try {
        const location = await getLocationWithRetry();
        const { latitude, longitude } = location.coords;
        setUserLocation({ latitude, longitude });
      } catch (error) {
        console.error('Error getting location:', error);
        // FIXME: Handle the error appropriately
      }
    };

    setLoading(true);
    if (isFocused) {
      fetchUsername();
      getUserLocation();
    }
  }, [isFocused]); // called when navigation is updated (clicking the page, or when username is changed)

  // this is just to print out a profile's information for now
  useEffect(() => {
    if (userLocation &amp;&amp; profileInfo) {
      setLoading(false);
    }

    if (selfProfile) {
      setRoutes([
        { key: 'first', title: 'My Listings' },
        { key: 'second', title: 'Liked' },
        { key: 'third', title: 'Contact' },
      ]);
    } else {
      setRoutes([
        { key: 'first', title: `${profileName}'s listings` },
        { key: 'third', title: `${profileName}'s contact` },
      ]);
    }
  }, [profileInfo, userLocation]);

  const getProfileInfo = async function (username) {
    console.log(`Fetching profile info for ${username}`);
    try {
      const fetchUrl = `${serverIp}/api/profile?username=${encodeURIComponent(
        getStoredUsername(),
      )}&amp;password=${getStoredPassword()}&amp;profileName=${username}`;
      console.log(fetchUrl);
      const profileResponse = await fetch(fetchUrl, {
        method: 'GET',
      });
      const profileData = await profileResponse.json();
      // console.log(profileData);

      if (profileResponse.status &lt;= 201) {
        setProfileInfo({
          likedListings: profileData.likedListings.map((listing) => {
            const timeSince = calculateTimeSince(listing.PostDate);
            return {
              ...listing,
              TimeSince: timeSince,
            };
          }),
          userListings: profileData.userListings.map((listing) => {
            const timeSince = calculateTimeSince(listing.PostDate);
            return {
              ...listing,
              TimeSince: timeSince,
            };
          }),
          userRatings: profileData.ratings.reduce(
            (acc, rating) => ({ ...acc, ...rating }),
            {},
          ),
          profilePicture: profileData.profilePicture,
          coverPicture: profileData.coverPicture,
          email: profileData.email,
        });

        // Set the contactInfo state
        const updatedContactInfo = { ...contactInfo };
        for (const key in profileData.contactInfo) {
          updatedContactInfo[key].hidden = profileData.contactInfo[key].hidden;
          updatedContactInfo[key].data = profileData.contactInfo[key].data;
        }
        setContactInfo(updatedContactInfo);

        const initialLikeStates = Object.fromEntries(
          [...profileData.likedListings, ...profileData.userListings].map(
            (listing) => [listing.ListingId, listing.liked],
          ),
        );
        setLikeStates(initialLikeStates);

        console.log(`Profile for ${username} fetched successfully`);
      } else {
        console.log(
          'Error fetching profile:',
          profileResponse.status,
          // profileData
        );
      }
    } catch (err) {
      console.log('Error:', err);
    }
  };

  // Like states
  const handleLikePress = async (listingId) => {
    // toggle the like
    const newLikeStates = { ...LikeStates }; // Create a copy of the current LikeStates
    newLikeStates[listingId] = !newLikeStates[listingId]; // Update the liked status

    const likeData = {
      username: await SecureStore.getItemAsync('username'),
      listingId: listingId,
    };

    // Update the backend
    const likedResponse = await fetch(`${serverIp}/api/like`, {
      method: newLikeStates[listingId] ? 'POST' : 'DELETE',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(likeData),
    });

    if (likedResponse.status > 201) {
      console.log('Error Liking listing:', listingId, likedResponse.status);
    }

    // Update the state with the new Like states object
    setLikeStates(newLikeStates);

    console.log(
      `${
        newLikeStates[listingId] ? 'Likered' : 'UnLikered'
      } listing ID ${listingId}`,
    );
  };

  const renderTabBar = (props) => (
    &lt;TabBar
      {...props}
      indicatorStyle={{
        backgroundColor:
          theme === 'light' ? Colors.BB_darkRedPurple : Colors.BB_violet,
      }}
      style={{
        backgroundColor: Colors.bone,
        height: 44,
      }}
      renderLabel={({ focused, route }) => (
        &lt;Text
          style={[
            {
              color:
                theme === 'light' ? Colors.BB_darkRedPurple : Colors.BB_violet,
              fontWeight: 'bold',
              fontSize: 14,
              textAlign: 'center',
            },
          ]}
        >
          {route.title}
        &lt;/Text>
      )}
    />
  );

  const handleLogout = () => {
    clearStoredCredentials();
    setLoading(true);
    navigation.navigate('Login');
  };

  if (loading) {
    return (
      &lt;View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>
        &lt;BouncePulse />
      &lt;/View>
    );
  }

  return (
    &lt;SafeAreaView
      style={{
        flex: 1,
        backgroundColor: theme === 'light' ? Colors.BB_bone : '#1e1e1e',
      }}
    >
      &lt;View style={styles.pageHeader} />
      {/* //Cover Photo */}
      &lt;View style={{ width: '100%' }}>
        &lt;Image
          source={{
            uri: profileInfo.coverPicture,
          }}
          resizeMode="cover"
          style={{
            width: '100%',
            height: 0.2 * screenHeight,
            borderWidth: 1,
            borderColor:
              theme === 'light' ? Colors.BB_darkRedPurple : Colors.BB_violet,
            position: 'absolute',
          }}
        />
      &lt;/View>

      {/* //Profile Picture */}
      &lt;View style={{ flex: 1, alignItems: 'center' }}>
        &lt;Image
          source={{
            uri: profileInfo.profilePicture,
          }}
          resizeMode="cover"
          style={{
            height: 0.38 * screenWidth,
            width: 0.38 * screenWidth,
            borderRadius: 999,
            borderColor:
              theme === 'light' ? Colors.BB_darkRedPurple : Colors.BB_violet,
            borderWidth: 2,
            marginTop: -90,
            position: 'absolute',
            top: 0.2 * screenHeight,
            backgroundColor: theme === 'light' ? 'white' : '#2d2d30',
          }}
        />
        &lt;Text
          style={{
            top: 0.28 * screenHeight,
            marginTop: 10,
            marginBottom: 5,
            fontStyle: 'normal',
            fontWeight: 'bold',
            fontSize: 25,
            color: theme === 'light' ? Colors.BB_darkRedPurple : Colors.BB_bone,
          }}
        >
          {profileName}
        &lt;/Text>

        {/* Rating, Following, Likes */}
        &lt;View
          style={{
            paddingVertical: 2,
            flexDirection: 'row',
            top: 0.28 * screenHeight,
            alignItems: 'center',
          }}
        >
          {/* Listings */}
          &lt;View
            style={{
              flexDirection: 'column',
              alignItems: 'center',
            }}
          >
            &lt;Text
              style={{
                fontStyle: 'normal',
                fontWeight: 'bold',
                fontSize: 20,
                color:
                  theme === 'light' ? Colors.BB_darkRedPurple : Colors.BB_bone,
              }}
            >
              {profileInfo.userListings?.length}
            &lt;/Text>
            &lt;Text
              style={{
                fontStyle: 'normal',
                color:
                  theme === 'light' ? Colors.BB_darkRedPurple : Colors.BB_bone,
              }}
            >
              Listings
            &lt;/Text>
          &lt;/View>
          {/* Rating */}
          &lt;View
            style={{
              flexDirection: 'column',
              alignItems: 'center',
              marginHorizontal: selfProfile ? 25 : 10,
              marginEnd: !selfProfile ? -10 : 25,
            }}
          >
            &lt;Text
              style={{
                fontStyle: 'normal',
                fontWeight: 'bold',
                fontSize: 20,
                color:
                  theme === 'light' ? Colors.BB_darkRedPurple : Colors.BB_bone,
              }}
            >
              {profileInfo.userRatings.AverageRating
                ? profileInfo.userRatings.AverageRating.toFixed(1)
                : 'N/A'}
              {profileInfo.userRatings.RatingCount > 0 &amp;&amp; (
                &lt;Entypo
                  name="star"
                  size={20}
                  color={theme === 'light' ? 'gold' : Colors.BB_violet}
                  style={styles.ratingStar}
                />
              )}
            &lt;/Text>
            &lt;Text
              style={{
                alignContent: 'center',
                fontStyle: 'normal',
                color:
                  theme === 'light' ? Colors.BB_darkRedPurple : Colors.BB_bone,
              }}
            >
              Rating ({profileInfo.userRatings.RatingCount})
            &lt;/Text>
          &lt;/View>

          {/* LIKED */}
          {selfProfile &amp;&amp; (
            &lt;View
              style={{
                flexDirection: 'column',
                alignItems: 'center',
              }}
            >
              &lt;Text
                style={{
                  fontStyle: 'normal',
                  fontWeight: 'bold',
                  fontSize: 20,
                  color:
                    theme === 'light'
                      ? Colors.BB_darkRedPurple
                      : Colors.BB_bone,
                }}
              >
                {profileInfo.likedListings?.length}
              &lt;/Text>
              &lt;Text
                style={{
                  fontStyle: 'normal',
                  color:
                    theme === 'light'
                      ? Colors.BB_darkRedPurple
                      : Colors.BB_bone,
                }}
              >
                Liked
              &lt;/Text>
            &lt;/View>
          )}
        &lt;/View>
        {/* Logout and Edit Profile Buttons */}
        {selfProfile &amp;&amp; (
          &lt;View
            style={{
              flexDirection: 'row',
              paddingVertical: 10,
              top: 0.28 * screenHeight,
              marginBottom: -100,
            }}
          >
            {/* Logout */}
            &lt;View style={{ paddingHorizontal: 10 }}>
              &lt;TouchableOpacity onPress={handleLogout} style={styles.button}>
                &lt;Text style={styles.buttonText}>Logout&lt;/Text>
              &lt;/TouchableOpacity>
            &lt;/View>
            {/* Edit Profile */}
            &lt;View style={{ paddingHorizontal: 10 }}>
              &lt;TouchableOpacity
                onPress={() => {
                  setLoading(true);
                  navigation.navigate('EditProfile', {
                    profileName: profileName,
                    profilePicture: profileInfo.profilePicture,
                    coverPicture: profileInfo.coverPicture,
                    email: profileInfo.email,
                  });
                }}
                style={{ ...styles.button, width: 114 }}
              >
                &lt;Text style={styles.buttonText}>Edit Profile&lt;/Text>
              &lt;/TouchableOpacity>
            &lt;/View>
          &lt;/View>
        )}
        {/* Rate User Button */}
        {!selfProfile &amp;&amp; (
          &lt;View
            style={{
              flexDirection: 'row',
              marginTop: 5,
              top: 0.28 * screenHeight,
              marginBottom: -100,
            }}
          >
            &lt;TouchableOpacity
              onPress={() => {
                setLoading(true);
                navigation.navigate('RatingScreen', {
                  profileInfo: profileInfo,
                  username: profileName,
                });
              }}
              style={{ ...styles.button }}
            >
              &lt;Text
                style={{
                  fontStyle: 'normal',
                  color: 'white',
                }}
              >
                Rate User
              &lt;/Text>
            &lt;/TouchableOpacity>
          &lt;/View>
        )}
      &lt;/View>

      {/* Back button */}
      {!selfProfile &amp;&amp; (
        &lt;TouchableOpacity
          onPress={() => {
            setLoading(true);
            navigation.navigate('BottomNavOverlay');
          }}
          style={styles.circleContainer}
        >
          &lt;View style={styles.circle}>
            &lt;MaterialCommunityIcons
              name="arrow-left"
              size={30}
              color={
                theme === 'light' ? Colors.BB_darkRedPurple : Colors.BB_violet
              }
            />
          &lt;/View>
        &lt;/TouchableOpacity>
      )}

      &lt;View
        style={{
          flex: 1,
          marginHorizontal: 22,
          marginTop: selfProfile ? 20 : 0,
        }}
      >
        &lt;TabView
          navigationState={{ index, routes }}
          renderScene={({ route }) => {
            switch (route.key) {
              case 'first':
                return (
                  &lt;ListingsRoute
                    onPressListing={onPressListing}
                    data={profileInfo.userListings}
                    text={'user'}
                    styles={styles}
                  />
                );
              case 'second':
                return (
                  &lt;ListingsRoute
                    onPressListing={onPressListing}
                    data={profileInfo.likedListings}
                    text={'liked'}
                    styles={styles}
                  />
                );
              case 'third':
                return (
                  &lt;ContactInfoRoute
                    selfProfile={selfProfile}
                    contactInfo={contactInfo}
                    setContactInfo={setContactInfo}
                    styles={styles}
                  />
                );
              default:
                return null;
            }
          }}
          onIndexChange={setIndex}
          initialLayout={{ width: layout.width }}
          renderTabBar={renderTabBar}
        />
      &lt;/View>

      {/* Settings */}
      {selfProfile &amp;&amp; (
        &lt;TouchableOpacity
          onPress={() => {
            setLoading(true);
            navigation.navigate('SettingsScreen', {
              prevContactInfo: contactInfo,
              profileName: profileName,
            });
          }}
          style={{
            position: 'absolute',
            top: Platform.OS == 'ios' ? 55 : 40,
            right: Platform.OS == 'ios' ? 10 : 15,
          }}
        >
          &lt;View style={styles.circle}>
            &lt;MaterialIcons
              name="settings"
              size={30}
              color={
                theme === 'light' ? Colors.BB_darkRedPurple : Colors.BB_violet
              }
            />
          &lt;/View>
        &lt;/TouchableOpacity>
      )}

      {/* Overlay for displaying selected listing */}
      {selectedListing &amp;&amp; (
        &lt;View
          style={{
            flex: 1,
            alignItems: 'center',
            justifyContent: 'center',
            backgroundColor: 'rgba(0, 0, 0, 0.7)',
            position: 'absolute',
            top: 0,
            bottom: 0,
            left: 0,
            right: 0,
          }}
        >
          &lt;View
            style={{
              top:
                Platform.OS == 'ios'
                  ? 0.03 * screenHeight
                  : -0.05 * screenHeight,
            }}
          >
            &lt;Listing
              key={selectedListing.ListingId}
              item={selectedListing}
              LikeStates={LikeStates}
              handleLikePress={handleLikePress}
              numItems={selectedListing.images?.length}
              userLocation={userLocation}
              origin={'profile'}
              removeListing={(listingId) => {
                setProfileInfo((prevProfileInfo) => ({
                  ...prevProfileInfo,
                  likedListings: prevProfileInfo.likedListings.filter(
                    (item) => item.ListingId !== listingId,
                  ),
                  userListings: prevProfileInfo.userListings.filter(
                    (item) => item.ListingId !== listingId,
                  ),
                }));

                setSelectedListing(null);
              }}
            />
          &lt;/View>
          &lt;TouchableOpacity
            onPress={() => setSelectedListing(null)}
            style={{
              ...styles.button,
              top: selfProfile
                ? Platform.OS === 'ios'
                  ? -0.035 * screenHeight
                  : -0.05 * screenHeight
                : Platform.OS === 'ios'
                  ? -0.1 * screenHeight
                  : -0.12 * screenHeight,
            }}
          >
            &lt;Text style={styles.buttonText}>Close&lt;/Text>
          &lt;/TouchableOpacity>
        &lt;/View>
      )}
    &lt;/SafeAreaView>
  );
}

export default memo(ProfileScreen);
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Sun Dec 03 2023 19:55:26 GMT-0800 (Pacific Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
