<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Frontend/screens/HomeScreen.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/NaveFlactem/BlitzBuyr" target="_blank" class="menu-item" id="repository" >Github repo</a></h2><h3>Classes</h3><ul><li><a href="Components.CustomFlipCard.Back.html">Components.CustomFlipCard.Back</a><ul class='members'><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.Back.html#.Back.defaultProps">Back.defaultProps</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.Back.html#.Back.propTypes">Back.propTypes</a></li></ul></li><li><a href="Components.CustomFlipCard.Face.html">Components.CustomFlipCard.Face</a><ul class='members'><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.Face.html#.Face.propTypes">Face.propTypes</a></li></ul></li><li><a href="Components.CustomFlipCard.FlipCard.html">Components.CustomFlipCard.FlipCard</a><ul class='members'><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.FlipCard.defaultProps">FlipCard.defaultProps</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.lastTap">lastTap</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.measureOtherSideTimeout">measureOtherSideTimeout</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.measured">measured</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.propTypes">propTypes</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.propTypes">propTypes</a></li><li data-type='member' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.tapTimeout">tapTimeout</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#._animation">_animation</a></li><li data-type='method' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.componentDidUpdate">componentDidUpdate</a></li><li data-type='method' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.constructor">constructor</a></li><li data-type='method' style='display: none;'><a href="Components.CustomFlipCard.FlipCard.html#.getDerivedStateFromProps">getDerivedStateFromProps</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-API_Accounts.html">API/Accounts</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-API_Accounts.html#~authenticateUser">authenticateUser</a></li><li data-type='method' style='display: none;'><a href="module-API_Accounts.html#~getAccounts">getAccounts</a></li><li data-type='method' style='display: none;'><a href="module-API_Accounts.html#~handleDeleteAccounts">handleDeleteAccounts</a></li><li data-type='method' style='display: none;'><a href="module-API_Accounts.html#~handleLoginRequest">handleLoginRequest</a></li><li data-type='method' style='display: none;'><a href="module-API_Accounts.html#~handleRegistrationRequest">handleRegistrationRequest</a></li></ul></li><li><a href="module-API_Listings.html">API/Listings</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~createListing">createListing</a></li><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~encodeImageToBlurhash">encodeImageToBlurhash</a></li><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~getImages">getImages</a></li><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~getListings">getListings</a></li><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~handleDeleteImages">handleDeleteImages</a></li><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~handleDeleteListing">handleDeleteListing</a></li><li data-type='method' style='display: none;'><a href="module-API_Listings.html#~handleDeleteListings">handleDeleteListings</a></li></ul></li><li><a href="module-API_Profile.html">API/Profile</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~deleteAllLikes">deleteAllLikes</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~deleteRating">deleteRating</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~getLikes">getLikes</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~getProfilePicture">getProfilePicture</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~getRatings">getRatings</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~getUserProfile">getUserProfile</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~handleLike">handleLike</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~handleUnlike">handleUnlike</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~rateUser">rateUser</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~updateContactInfo">updateContactInfo</a></li><li data-type='method' style='display: none;'><a href="module-API_Profile.html#~updateProfile">updateProfile</a></li></ul></li><li><a href="module-Database.html">Database</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Database.html#~areTableDefinitionsEqual">areTableDefinitionsEqual</a></li><li data-type='method' style='display: none;'><a href="module-Database.html#~createOrUpdateTable">createOrUpdateTable</a></li><li data-type='method' style='display: none;'><a href="module-Database.html#~createTables">createTables</a></li><li data-type='method' style='display: none;'><a href="module-Database.html#~extractColumnsFromDefinition">extractColumnsFromDefinition</a></li></ul></li><li><a href="module-Server.html">Server</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Server.html#~getRoot">getRoot</a></li><li data-type='method' style='display: none;'><a href="module-Server.html#~requestLogger">requestLogger</a></li></ul></li></ul><h3>Namespaces</h3><ul><li><a href="Components.html">Components</a></li><li><a href="Components.CalculateFontSize.html">Components.CalculateFontSize</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.CalculateFontSize.html#.calculateFontSize">calculateFontSize</a></li><li data-type='method' style='display: none;'><a href="Components.CalculateFontSize.html#.calculateFontSizeLocation">calculateFontSizeLocation</a></li><li data-type='method' style='display: none;'><a href="Components.CalculateFontSize.html#.calculateTagTextFontSize">calculateTagTextFontSize</a></li><li data-type='method' style='display: none;'><a href="Components.CalculateFontSize.html#.calculateTransactionFontSize">calculateTransactionFontSize</a></li></ul></li><li><a href="Components.CustomFlipCard.html">Components.CustomFlipCard</a></li><li><a href="Components.Listing.html">Components.Listing</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Listing.html#.CardOverlay">CardOverlay</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.CustomItem">CustomItem</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.DeleteButton">DeleteButton</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.LikeButton">LikeButton</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.Listing">Listing</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.MemoizedImage">MemoizedImage</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.TimeBox">TimeBox</a></li><li data-type='method' style='display: none;'><a href="Components.Listing.html#.getDistance">getDistance</a></li></ul></li><li><a href="Components.LocationSlider.html">Components.LocationSlider</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.LocationSlider.html#.LocationSlider">LocationSlider</a></li></ul></li><li><a href="Components.NoListings.html">Components.NoListings</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.NoListings.html#.NoListings">NoListings</a></li></ul></li><li><a href="Components.NoWifi.html">Components.NoWifi</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.NoWifi.html#.NoWifi">NoWifi</a></li></ul></li><li><a href="Components.Notifications.html">Components.Notifications</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Notifications.html#.checkListingExpiration">checkListingExpiration</a></li><li data-type='method' style='display: none;'><a href="Components.Notifications.html#.likedNotification">likedNotification</a></li><li data-type='method' style='display: none;'><a href="Components.Notifications.html#.scheduleNotification">scheduleNotification</a></li></ul></li><li><a href="Components.Swipers.html">Components.Swipers</a></li><li><a href="Components.Swipers.AndroidSwiperComponent.html">Components.Swipers.AndroidSwiperComponent</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Swipers.AndroidSwiperComponent.html#.AndroidSwiperComponent">AndroidSwiperComponent</a></li></ul></li><li><a href="Components.Swipers.IOSSwiperComponent.html">Components.Swipers.IOSSwiperComponent</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Swipers.IOSSwiperComponent.html#.IOSSwiperComponent">IOSSwiperComponent</a></li></ul></li><li><a href="Components.TagDrawer.html">Components.TagDrawer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.TagDrawer.html#.TagDrawer">TagDrawer</a></li></ul></li><li><a href="Components.TopBarHome.html">Components.TopBarHome</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.TopBarHome.html#.TopBar">TopBar</a></li></ul></li><li><a href="Components.Visuals.html">Components.Visuals</a></li><li><a href="Components.Visuals.BouncePulse.html">Components.Visuals.BouncePulse</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Visuals.BouncePulse.html#.BouncePulse">BouncePulse</a></li></ul></li><li><a href="Components.Visuals.CustomRefreshControl.html">Components.Visuals.CustomRefreshControl</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Visuals.CustomRefreshControl.html#.CustomRefreshControl">CustomRefreshControl</a></li></ul></li><li><a href="Components.Visuals.Icons.html">Components.Visuals.Icons</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Visuals.Icons.html#.Icon">Icon</a></li></ul></li><li><a href="Components.Visuals.ThemeProvider.html">Components.Visuals.ThemeProvider</a><ul class='members'><li data-type='member' style='display: none;'><a href="Components.Visuals.ThemeProvider.html#.ThemeProvider">ThemeProvider</a></li></ul></li><li><a href="Components.Visuals.TopBarGeneric.html">Components.Visuals.TopBarGeneric</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Components.Visuals.TopBarGeneric.html#.TopBar">TopBar</a></li></ul></li><li><a href="Hooks.html">Hooks</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Hooks.html#.useBackButtonHandler">useBackButtonHandler</a></li><li data-type='method' style='display: none;'><a href="Hooks.html#.useLocation">useLocation</a></li></ul></li><li><a href="ListingData.html">ListingData</a></li><li><a href="Networking.html">Networking</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Networking.html#.fetchListings">fetchListings</a></li><li data-type='method' style='display: none;'><a href="Networking.html#.handleDeleteAccount">handleDeleteAccount</a></li><li data-type='method' style='display: none;'><a href="Networking.html#.handleDeleteAccount">handleDeleteAccount</a></li><li data-type='method' style='display: none;'><a href="Networking.html#.handleLike">handleLike</a></li><li data-type='method' style='display: none;'><a href="Networking.html#.handleListingCreation">handleListingCreation</a></li><li data-type='method' style='display: none;'><a href="Networking.html#.saveContactInfo">saveContactInfo</a></li><li data-type='method' style='display: none;'><a href="Networking.html#.saveProfileInfo">saveProfileInfo</a></li></ul></li><li><a href="ScreenDimensions.html">ScreenDimensions</a></li><li><a href="Screens.html">Screens</a></li><li><a href="Screens.AboutUs.html">Screens.AboutUs</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.AboutUs.html#.AboutUsScreen">AboutUsScreen</a></li></ul></li><li><a href="Screens.Auth.html">Screens.Auth</a></li><li><a href="Screens.Auth.Authenticate.html">Screens.Auth.Authenticate</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.Auth.Authenticate.html#.AuthenticateScreen">AuthenticateScreen</a></li><li data-type='method' style='display: none;'><a href="Screens.Auth.Authenticate.html#.clearStoredCredentials">clearStoredCredentials</a></li><li data-type='method' style='display: none;'><a href="Screens.Auth.Authenticate.html#.getStoredPassword">getStoredPassword</a></li><li data-type='method' style='display: none;'><a href="Screens.Auth.Authenticate.html#.getStoredUsername">getStoredUsername</a></li><li data-type='method' style='display: none;'><a href="Screens.Auth.Authenticate.html#.setStoredCredentials">setStoredCredentials</a></li></ul></li><li><a href="Screens.Auth.CreateAccount.html">Screens.Auth.CreateAccount</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.Auth.CreateAccount.html#.CreateAccountScreen">CreateAccountScreen</a></li></ul></li><li><a href="Screens.Auth.Login.html">Screens.Auth.Login</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.Auth.Login.html#.LoginScreen">LoginScreen</a></li></ul></li><li><a href="Screens.ChangePasswordScreen.html">Screens.ChangePasswordScreen</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.ChangePasswordScreen.html#.ChangePassword">ChangePassword</a></li></ul></li><li><a href="Screens.CreateListing.html">Screens.CreateListing</a><ul class='members'><li data-type='member' style='display: none;'><a href="Screens.CreateListing.html#.blurhash">blurhash</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.CreateListing.html#.CreateListing">CreateListing</a></li><li data-type='method' style='display: none;'><a href="Screens.CreateListing.html#.LoadingView">LoadingView</a></li><li data-type='method' style='display: none;'><a href="Screens.CreateListing.html#.MinorLoadingView">MinorLoadingView</a></li></ul></li><li><a href="Screens.EditContactInfo.html">Screens.EditContactInfo</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.EditContactInfo.html#.EditContactInfo">EditContactInfo</a></li></ul></li><li><a href="Screens.EditProfile.html">Screens.EditProfile</a></li><li><a href="Screens.HomeScreen.html">Screens.HomeScreen</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.HomeScreen.html#.HomeScreen">HomeScreen</a></li></ul></li><li><a href="Screens.ProfileScreen.html">Screens.ProfileScreen</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.ProfileScreen.html#.ContactInfoRoute">ContactInfoRoute</a></li><li data-type='method' style='display: none;'><a href="Screens.ProfileScreen.html#.ListingsRoute">ListingsRoute</a></li><li data-type='method' style='display: none;'><a href="Screens.ProfileScreen.html#.ProfileScreen">ProfileScreen</a></li><li data-type='method' style='display: none;'><a href="Screens.ProfileScreen.html#.handleContactClick">handleContactClick</a></li></ul></li><li><a href="Screens.RatingScreen.html">Screens.RatingScreen</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.RatingScreen.html#.RatingScreen">RatingScreen</a></li></ul></li><li><a href="Screens.SettingsScreen.html">Screens.SettingsScreen</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Screens.SettingsScreen.html#.SettingsScreen">SettingsScreen</a></li></ul></li><li><a href="Styles.html">Styles</a></li><li><a href="UserSettings.html">UserSettings</a><ul class='methods'><li data-type='method' style='display: none;'><a href="UserSettings.html#.clearUserSettings">clearUserSettings</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.getColorMode">getColorMode</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.getDistance">getDistance</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.getUserSettings">getUserSettings</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.saveUserSettings">saveUserSettings</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.setDefaultUserSettings">setDefaultUserSettings</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.updateColorMode">updateColorMode</a></li><li data-type='method' style='display: none;'><a href="UserSettings.html#.updateDistance">updateDistance</a></li></ul></li><li><a href="Utilities.html">Utilities</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Utilities.html#.calculateTimeSince">calculateTimeSince</a></li><li data-type='method' style='display: none;'><a href="Utilities.html#.getLocationWithRetry">getLocationWithRetry</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#Slider">Slider</a></li><li><a href="global.html#default_blurhash">default_blurhash</a></li><li><a href="global.html#getThemedStyles">getThemedStyles</a></li><li><a href="global.html#styles">styles</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">Frontend/screens/HomeScreen.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import NetInfo from '@react-native-community/netinfo';
import React, { memo, useCallback, useEffect, useRef, useState } from 'react';
import {
  Platform,
  RefreshControl,
  SafeAreaView,
  TouchableOpacity,
  View,
} from 'react-native';
import { useSharedValue, withTiming } from 'react-native-reanimated';
import LocationSlider from '../components/LocationSlider';
import NoListings from '../components/NoListings';
import NoWifi from '../components/NoWifi';
import AndroidSwiperComponent from '../components/swipers/AndroidSwiperComponent.js';
import IOSSwiperComponent from '../components/swipers/IOSSwiperComponent.js';
import TagDrawer, { SwipeArea } from '../components/TagDrawer.js';
import TopBar from '../components/TopBarHome.js';
import BouncePulse from '../components/visuals/BouncePulse.js';
import { CustomRefreshControl } from '../components/visuals/CustomRefreshControl';
import { useThemeContext } from '../components/visuals/ThemeProvider';
import {
  conditionOptions,
  currencies,
  tagOptions,
  transactionOptions,
} from '../constants/ListingData.js';
import { screenWidth } from '../constants/ScreenDimensions.js';
import { getThemedStyles } from '../constants/Styles';
import { getLocationWithRetry } from '../constants/Utilities';
import * as Settings from '../hooks/UserSettings.js';
import { fetchListings } from '../network/Service';
import Colors from '../constants/Colors';
import { FlatList } from 'react-native-gesture-handler';
/**
 * @namespace HomeScreen
 * @memberof Screens
 * @description - HomeScreen is the home screen of the application
 *
 */

/**
 * Home screen component displaying listings and filters.
 * @function HomeScreen
 * @memberof Screens.HomeScreen
 * @param {object} route - Information about the current route.
 * @returns {JSX.Element} Home screen UI with listings and filters.
 * @description Renders the home screen displaying listings and various filters. Manages state for refreshing listings, network connectivity, loading state, user location, tag options, condition options, transaction options, selected tags, conditions, and transactions. Uses ref for swiper navigation and shared values for animation. Handles drawer visibility, distance settings, and location slider visibility.
 */
const HomeScreen = ({ route }) => {
  /**
   * @constant {boolean} refreshing - State variable to indicate whether the listings are being refreshed.
   * @constant {Array} listings - State variable to store the listings data.
   * @constant {React.RefObject&lt;FlatList>} swiperRef - Reference to the swiper FlatList component inside IOSSwiperComponent and AndroidSwiperComponent.
   * @constant {boolean} networkConnected - State variable to indicate whether the device is connected to the network.
   * @constant {boolean} isLoading - State variable to indicate whether the listings are being loaded.
   * @constant {object} userLocation - State variable to store the user's location.
   * @constant {Array} tagsData - State variable to store the tag options imported from ListingData.js (tagsData is a copy of tagOptions).
   * @constant {Array} conditions - State variable to store the condition options imported from ListingData.js (conditions is a copy of conditionOptions).
   * @constant {Array} transactions - State variable to store the transaction options imported from ListingData.js (transactions is a copy of transactionOptions).
   * @constant {Array} currencyData - State variable to store the currency options imported from ListingData.js (currencyData is a copy of currencies).
   * @constant {Array} selectedTags - State variable to store the selected tags.
   * @constant {Array} selectedConditions - State variable to store the selected conditions.
   * @constant {Array} selectedTransactions - State variable to store the selected transactions.
   * @constant {string} selectedCurrency - State variable to store the selected currency.
   * @constant {Animated.SharedValue} translateX - Shared value to store the horizontal translation of the tag drawer.
   * @constant {boolean} isDrawerOpen - State variable to indicate whether the tag drawer is open.
   * @constant {number} distance - State variable to store the distance setting.
   * @constant {boolean} isLocationSliderVisible - State variable to indicate whether the location slider is visible.
   * @constant {Animated.SharedValue} locationSliderHeight - Shared value to store the vertical translation of the location slider.
   * @constant {string} theme - State variable to store the current theme ('light' or 'dark')
   * @constant {object} styles - Style object containing default styles and styles for dark mode.
   */
  const [refreshing, setRefreshing] = useState(false);
  const [listings, setListings] = useState([]);
  const swiperRef = useRef(null);
  const [networkConnected, setNetworkConnected] = useState(true);
  const [isLoading, setIsLoading] = useState(true);
  const [userLocation, setUserLocation] = useState(null);
  const [tagsData, setTagsData] = useState([...tagOptions]);
  const [conditions, setConditionsData] = useState([...conditionOptions]);
  const [transactions, setTransactionsData] = useState([...transactionOptions]);
  const [currencyData, setCurrencyData] = useState([...currencies]);
  const [selectedTags, setSelectedTags] = useState([]);
  const [selectedConditions, setSelectedConditions] = useState([]);
  const [selectedTransactions, setSelectedTransactions] = useState([]);
  const [selectedCurrency, setSelectedCurrency] = useState('');
  const translateX = useSharedValue(-screenWidth);
  const [isDrawerOpen, setIsDrawerOpen] = useState(false);
  const [distance, setDistance] = useState(30);
  const [isLocationSliderVisible, setIsLocationSliderVisible] = useState(false);
  const locationSliderHeight = useSharedValue(-100); // Start off-screen
  const { theme } = useThemeContext();
  const styles = getThemedStyles(useThemeContext().theme).HomeScreen;

  /**
   *
   * @function
   * @name toggleTagDrawer
   * @memberof HomeScreen
   * @returns {void}
   * @description Controls the visibility of the tag drawer by toggling its state between open and closed. If the drawer is currently open, it animates its closure by sliding it to the left. If closed, it animates its opening by sliding it to the right.
   */
  const toggleTagDrawer = () => {
    if (translateX.value === -screenWidth * 0.6) {
      // Drawer is open, so close it
      translateX.value = withTiming(-screenWidth, {
        duration: 300,
      });
      setIsDrawerOpen(false);
    } else {
      // Drawer is closed, so open it
      translateX.value = withTiming(-screenWidth * 0.6, {
        duration: 300,
      });
      setIsDrawerOpen(true);
    }
  };

  /**
   *
   * @function
   * @name handleLocationPress
   * @memberof HomeScreen
   * @returns {void}
   * @description Controls the visibility of the location slider by toggling its state between visible and hidden. If the slider is currently visible, it initiates an animation to hide it and fetches listings. If hidden, it triggers an animation to display it.
   */

  const handleLocationPress = () => {
    console.log(
      'Location pressed, toggling slider visibility...',
      isLocationSliderVisible,
    );
    if (isLocationSliderVisible) {
      locationSliderHeight.value = withTiming(-100, { duration: 100 }); // Hide slider
      setIsLocationSliderVisible(false);
      fetchListingsAsync();
    } else {
      locationSliderHeight.value = withTiming(0, { duration: 100 }); // Show slider
      setIsLocationSliderVisible(true);
      console.log('location slider', isLocationSliderVisible);
    }
  };

  /**
   *
   * @function
   * @name handleInnerScrolling
   * @memberof HomeScreen
   * @param {React.RefObject&lt;FlatList>} swiperRef - Reference to the swiper FlatList component inside IOSSwiperComponent and AndroidSwiperComponent.
   * @returns {void}
   * @description Disables scrolling on the swiper component by setting its native property 'scrollEnabled' to 'false'.
   */
  handleInnerScolling = () => {
    swiperRef.current.setNativeProps({ scrollEnabled: false });
  };
  /**
   *
   * @function
   * @name handleInnerScrollingEnd
   * @memberof HomeScreen
   * @param {React.RefObject&lt;FlatListw>} swiperRef - Reference to the swiper FlatList component inside IOSSwiperComponent and AndroidSwiperComponent.
   * @returns {void}
   * @description Enables scrolling on the swiper component by setting its native property 'scrollEnabled' to 'true'.
   */
  handleInnerScollingEnd = () => {
    swiperRef.current.setNativeProps({ scrollEnabled: true });
  };

  /**
   *
   * @function
   * @name getUserLocation
   * @memberof HomeScreen
   * @returns {void}
   * @description Retrieves the user's location using `getLocationWithRetry` with retry mechanism. If successful, it extracts the latitude and longitude and sets the user's location in the component state. If an error occurs, it logs the error and requires appropriate error handling.
   * Error processing incomplete
   */
  const getUserLocation = async () => {
    console.log("Getting user's location...");

    try {
      const location = await getLocationWithRetry();
      const { latitude, longitude } = location.coords;
      setUserLocation({ latitude, longitude });
    } catch (error) {
      console.error('Error getting location:', error);
      // FIXME: Handle the error appropriately
    }
  };

  /**
   * Handles the retry action to fetch listings.
   * @function
   * @name retryButtonHandler
   * @memberof HomeScreen
   * @returns {void}
   * @description Initiates the refreshing state, triggering a fetch of listings data when a retry action is performed. Used typically in response to a failed or interrupted data fetch operation to attempt fetching listings again.
   */
  retryButtonHandler = () => {
    setRefreshing(true);
    fetchListingsAsync();
  };

  /**
   *
   * @function
   * @name onScroll
   * @memberof HomeScreen
   * @param {Object} event - The scroll event object.
   * @returns {void}
   * @description Updates the shared value `scrollY` with the current vertical scroll position obtained.
   */
  let scrollY = useSharedValue(0);
  const onScroll = (event) => {
    scrollY.value = event.nativeEvent.contentOffset.y;
  };

  /**
   *
   * @function
   * @name onRefresh
   * @memberof HomeScreen
   * @returns {void}
   * @description Initiates the refresh action by setting the refreshing state, and if the user location is available, it triggers fetching listings. If the user location is not available, it attempts to retrieve the user's location before fetching listings.
   */
  const onRefresh = React.useCallback(() => {
    console.log('refreshing...');
    setRefreshing(true);
    getUserLocation();
  }, [userLocation]);

  /**
   * Asynchronously fetches listings.
   *
   * @function
   * @name fetchListingsAsync
   * @memberof HomeScreen
   * @returns {Function} - Callback function
   * @description
   * Retrieves the listings asynchronously based on the state of the home screen
   *
   * @throws {Error} Throws an error if there is an issue during the fetching process.
   * @async
   * @see {@link fetchListings} - The original function for fetching listings.
   */
  const fetchListingsAsync = useCallback(async () => {
    try {
      await fetchListings(
        userLocation,
        distance,
        selectedTags,
        selectedConditions,
        selectedTransactions,
        selectedCurrency,
        setListings,
        setIsLoading,
        setRefreshing,
      );
    } catch (error) {
      console.error(error);
      alert(error);
    }
  }, [userLocation, distance, selectedTags, selectedConditions]);

  useEffect(() => {
    const unsubscribe = NetInfo.addEventListener((state) => {
      setNetworkConnected(state.isConnected);
    });

    return () => {
      unsubscribe();
    };
  }, []);

  useEffect(() => {
    const fetchDistance = async () => {
      const initialDistance = await Settings.getDistance();
      console.log('Initial distance:', initialDistance);
      setDistance(initialDistance);
    };

    fetchDistance();
  }, []);

  // This will run on mount
  useEffect(() => {
    getUserLocation();
  }, []);

  // this will run after you have location
  useEffect(() => {
    if (userLocation) fetchListingsAsync();
  }, [userLocation]);

  useEffect(() => {
    if (userLocation &amp;&amp; !isDrawerOpen) fetchListingsAsync();
  }, [isDrawerOpen]);

  // This will run with refresh = true
  useEffect(() => {
    if (route.params?.refresh) {
      setRefreshing(true);
      if (userLocation) fetchListingsAsync();
      else getUserLocation();
    }
  }, [route.params]);

  const LoadingView = memo(() => (
    &lt;View style={styles.loadingContainer}>
      &lt;BouncePulse />
    &lt;/View>
  ));

  if (isLoading) {
    return (
      &lt;SafeAreaView style={styles.screenfield}>
        &lt;TopBar
          handleMenuPress={toggleTagDrawer}
          handleLocationPress={handleLocationPress}
        />
        &lt;LoadingView />
      &lt;/SafeAreaView>
    );
  }

  return (
    &lt;SafeAreaView style={styles.screenfield}>
      &lt;TopBar
        handleMenuPress={toggleTagDrawer}
        handleLocationPress={handleLocationPress}
      />

      &lt;View
        style={styles.topTap}
        onStartShouldSetResponder={() => true}
        onResponderRelease={() => {
          if (swiperRef.current) {
            swiperRef.current.scrollToOffset({ animated: true, offset: 0 });
          }
        }}
      />

      {networkConnected ? (
        listings &amp;&amp; listings.length > 0 ? (
          Platform.OS === 'ios' ? (
            &lt;View style={styles.swiperContainer}>
              &lt;IOSSwiperComponent
                swiperRef={swiperRef}
                listings={listings}
                userLocation={userLocation}
                removeListing={(listingId) => {
                  setListings((prevListings) =>
                    prevListings.filter((item) => item.ListingId !== listingId),
                  );
                }}
                onScroll={onScroll}
                refreshControl={
                  &lt;View>
                    &lt;CustomRefreshControl
                      refreshing={refreshing}
                      scrollY={scrollY}
                    />
                    &lt;RefreshControl
                      refreshing={refreshing}
                      onRefresh={onRefresh}
                      tintColor="transparent"
                      colors="transparent"
                      titleColor="transparent"
                      progressViewOffset={30}
                    />
                  &lt;/View>
                }
                handleInnerScolling={handleInnerScolling}
                handleInnerScollingEnd={handleInnerScollingEnd}
              />
            &lt;/View>
          ) : (
            &lt;View style={styles.swiperContainer}>
              &lt;AndroidSwiperComponent
                swiperRef={swiperRef}
                listings={listings}
                userLocation={userLocation}
                removeListing={(listingId) => {
                  setListings((prevListings) =>
                    prevListings.filter((item) => item.ListingId !== listingId),
                  );
                }}
                onScroll={onScroll}
                refreshControl={
                  &lt;RefreshControl
                    refreshing={refreshing}
                    onRefresh={onRefresh}
                    progressViewOffset={60}
                    colors={
                      theme === 'dark' ? [Colors.BB_violet] : [Colors.BB_bone]
                    }
                    tintColor={
                      theme === 'dark' ? Colors.BB_violet : Colors.BB_bone
                    }
                    progressBackgroundColor={
                      theme === 'dark' ? '#3e3e42' : Colors.BB_darkRedPurple
                    }
                  />
                }
                handleInnerScolling={handleInnerScolling}
                handleInnerScollingEnd={handleInnerScollingEnd}
              />
            &lt;/View>
          )
        ) : (
          &lt;NoListings onRetry={retryButtonHandler} />
        )
      ) : (
        &lt;NoWifi onRetry={retryButtonHandler} />
      )}

      &lt;TagDrawer
        tagsData={tagsData}
        conditions={conditions}
        transactions={transactions}
        currencyData={currencyData}
        setTagsData={setTagsData}
        setConditionsData={setConditionsData}
        setTransactionsData={setTransactionsData}
        setCurrencyData={setCurrencyData}
        selectedTags={selectedTags}
        selectedConditions={selectedConditions}
        selectedTransactions={selectedTransactions}
        selectedCurrency={selectedCurrency}
        setSelectedTags={setSelectedTags}
        setSelectedConditions={setSelectedConditions}
        setSelectedTransactions={setSelectedTransactions}
        setSelectedCurrency={setSelectedCurrency}
        fetchListings={fetchListingsAsync}
        handleMenuPress={toggleTagDrawer}
        setIsDrawerOpen={setIsDrawerOpen}
        isDrawerOpen={isDrawerOpen}
        translateX={translateX}
      />

      &lt;SwipeArea
        handleSwipe={toggleTagDrawer}
        translateX={translateX}
        setIsDrawerOpen={setIsDrawerOpen}
        isDrawerOpen={isDrawerOpen}
      />

      {isLocationSliderVisible &amp;&amp; (
        &lt;TouchableOpacity
          style={styles.sliderCover}
          onPress={handleLocationPress}
        />
      )}

      &lt;LocationSlider
        setDistance={setDistance}
        isLocationSliderVisible={isLocationSliderVisible}
        setIsLocationSliderVisible={setIsLocationSliderVisible}
        locationSliderHeight={locationSliderHeight}
      />
    &lt;/SafeAreaView>
  );
};

export default HomeScreen;
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Sun Dec 03 2023 19:55:26 GMT-0800 (Pacific Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
